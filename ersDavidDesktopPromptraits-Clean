
                   SSUUMMMMAARRYY OOFF LLEESSSS CCOOMMMMAANNDDSS

      Commands marked with * may be preceded by a number, _N.
      Notes in parentheses indicate the behavior if _N is given.
      A key preceded by a caret indicates the Ctrl key; thus ^K is ctrl-K.

  h  H                 Display this help.
  q  :q  Q  :Q  ZZ     Exit.
 ---------------------------------------------------------------------------

                           MMOOVVIINNGG

  e  ^E  j  ^N  CR  *  Forward  one line   (or _N lines).
  y  ^Y  k  ^K  ^P  *  Backward one line   (or _N lines).
  ESC-j             *  Forward  one file line (or _N file lines).
  ESC-k             *  Backward one file line (or _N file lines).
  f  ^F  ^V  SPACE  *  Forward  one window (or _N lines).
  b  ^B  ESC-v      *  Backward one window (or _N lines).
  z                 *  Forward  one window (and set window to _N).
  w                 *  Backward one window (and set window to _N).
  ESC-SPACE         *  Forward  one window, but don't stop at end-of-file.
  ESC-b             *  Backward one window, but don't stop at beginning-of-file.
  d  ^D             *  Forward  one half-window (and set half-window to _N).
  u  ^U             *  Backward one half-window (and set half-window to _N).
  ESC-)  RightArrow *  Right one half screen width (or _N positions).
  ESC-(  LeftArrow  *  Left  one half screen width (or _N positions).
  ESC-}  ^RightArrow   Right to last column displayed.
  ESC-{  ^LeftArrow    Left  to first column.
  F                    Forward forever; like "tail -f".
  ESC-F                Like F but stop when search pattern is found.
  r  ^R  ^L            Repaint screen.
  R                    Repaint screen, discarding buffered input.
        ---------------------------------------------------
        Default "window" is the screen height.
        Default "half-window" is half of the screen height.
 ---------------------------------------------------------------------------
[1mdiff --git a/src/App.jsx b/src/App.jsx[m
[1mindex 07a84ee..6eab81c 100644[m
[1m--- a/src/App.jsx[m
[1m+++ b/src/App.jsx[m
[36m@@ -1,7 +1,7 @@[m
 Ôªøimport React, { useState, useMemo, useEffect } from "react";[m
 import { Camera, Check, Instagram, Send, Menu, X, Download, Copy, Gift, Crown, Lock, ChevronDown, ChevronUp, Lightbulb, Trash2, Upload, Sparkles } from "lucide-react";[m
 [m
[31m-import { useAuth } from './contexts/AuthContext.jsx';[m
[32m+[m[32mimport { AuthProvider, useAuth } from './contexts/AuthContext.jsx';[m
 import { supabase } from './lib/supabase.js';[m
 [m
 import AnimatedSection from './components/AnimatedSection.jsx';[m
[36m@@ -551,535 +551,153 @@[m [mfunction PromptHistory() {[m
 [m
 // APP principal (UI final ajustada)[m
 export default function App() {[m
[31m-  const [view, setView] = useState('home');[m
[31m-  const [galleryFilter, setGalleryFilter] = useState('todos');[m
[31m-  const [toastText, setToastText] = useState("");[m
[31m-  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);[m
[31m-  const { user, profile, signOut } = useAuth();[m
[31m-  const [showLogin, setShowLogin] = useState(false);[m
[31m-  const [showRegister, setShowRegister] = useState(false);[m
[31m-  const [showCheckout, setShowCheckout] = useState(false);[m
[31m-  const [showProPresets, setShowProPresets] = useState(false);[m
[31m-  const [showPricing, setShowPricing] = useState(false); // A√ëADIDO ESTADO PARA MOSTRAR PRICING[m
[31m-[m
[31m-  // Exponer funci√≥n global para que componentes hijos puedan mostrar toasts[m
[31m-  React.useEffect(() => {[m
[31m-    window.App_showToast = (text) => {[m
[31m-      setToastText(text);[m
[31m-      setTimeout(() => setToastText(""), 2000);[m
[31m-    };[m
[31m-    // permitir refrescar perfil desde backend[m
[31m-    window.App_refreshProfile = async () => {[m
[31m-      try {[m
[31m-        const res = await fetch('/api/profile');[m
[31m-        if (res.ok) {[m
[31m-          // implementaci√≥n espec√≠fica puede variar; simple reload:[m
[31m-          console.log(' Recargando p√°gina...');[m
[31m-    window.location.reload();[m
[31m-        }[m
[31m-      } catch (err) { /* noop */ }[m
[31m-    };[m
[31m-    return () => { delete window.App_showToast; delete window.App_refreshProfile; };[m
[31m-  }, []);[m
[31m-[m
[31m-  const showToast = (text) => {[m
[31m-    setToastText(text);[m
[31m-    setTimeout(() => setToastText(""), 2000);[m
[31m-  };[m
[31m-[m
[31m-  const handleCopy = (text) => {[m
[31m-    if (!text) return;[m
[31m-    navigator.clipboard.writeText(text);[m
[31m-    showToast("√Ç¬°Prompt copiado!");[m
[31m-  };[m
[31m-[m
[31m-  const filteredPrompts = useMemo(() =>[m
[31m-    galleryFilter === 'todos' ? ALL_PROMPTS : ALL_PROMPTS.filter(p => p.category === galleryFilter),[m
[31m-    [galleryFilter][m
[31m-  );[m
[32m+[m[32m  return ([m
[32m+[m[32m    <AuthProvider>[m
[32m+[m[32m      <AppContent />[m
[32m+[m[32m    </AuthProvider>[m
[32m+[m[32m  )[m
[32m+[m[32m}[m
 [m
[31m-  const homePrompts = useMemo(() => {[m
[31m-    const categories = ['hombre', 'mujer', 'mascotas', 'halloween'];[m
[31m-    return categories.map(cat => ALL_PROMPTS.find(p => p.category === cat)).filter(Boolean);[m
[31m-  }, []);[m
[32m+[m[32mfunction AppContent() {[m
[32m+[m[32m  const { user, profile, signOut } = useAuth()[m
[32m+[m[32m  const [view, setView] = useState('gallery')[m
[32m+[m[32m  const [showAuth, setShowAuth] = useState(false)[m
[32m+[m[32m  const [authMode, setAuthMode] = useState('login')[m
[32m+[m[32m  const [selectedPlan, setSelectedPlan] = useState(null) // ‚Üê A√ëADIR ESTA L√çNEA[m
[32m+[m[32m  const [showCheckout, setShowCheckout] = useState(false) // ‚Üê A√ëADIR ESTA L√çNEA[m
 [m
[31m-  const navigateToPage = (page) => {[m
[31m-    setView(page);[m
[31m-    setMobileMenuOpen(false);[m
[31m-    window.scrollTo(0, 0);[m
[31m-  };[m
[32m+[m[32m  const handleNavigation = async (action) => {[m
[32m+[m[32m    console.log('üî¥ handleNavigation:', action)[m
 [m
[31m-  const isPaid = profile?.plan && profile.plan !== 'free';[m
[31m-  const presetsToShow = isPaid ? PRESETS : PRESETS.filter(p => p.free).slice(0, 6);[m
[31m-[m
[31m-  // Abrir Stripe Customer Portal[m
[31m-  const openStripePortal = async () => {[m
[31m-    try {[m
[31m-      const res = await fetch('/api/stripe/create-portal', {[m
[31m-        method: 'POST',[m
[31m-        headers: { 'Content-Type': 'application/json' },[m
[31m-        body: JSON.stringify({[m
[31m-          customerId: profile?.stripe_customer_id,[m
[31m-          returnUrl: window.location.origin[m
[31m-        })[m
[31m-      });[m
[31m-      const data = await res.json();[m
[31m-      if (data?.url) {[m
[31m-        window.location.href = data.url;[m
[31m-      } else {[m
[31m-        alert('No se pudo abrir el portal de facturaci√≥n.');[m
[32m+[m[32m    if (action === 'logout') {[m
[32m+[m[32m      console.log('üî¥ CERRANDO SESI√ìN - Inicio')[m
[32m+[m[32m      try {[m
[32m+[m[32m        const { error } = await signOut()[m
[32m+[m[32m        if (error) {[m
[32m+[m[32m          console.error('‚ùå Error en signOut:', error)[m
[32m+[m[32m          throw error[m
[32m+[m[32m        }[m
[32m+[m[32m        console.log('‚úÖ signOut() ejecutado')[m
[32m+[m[32m        console.log('üîÑ Recargando p√°gina...')[m
[32m+[m[32m        window.location.reload()[m
[32m+[m[32m      } catch (error) {[m
[32m+[m[32m        console.error('‚ùå Error al cerrar sesi√≥n:', error)[m
       }[m
[31m-    } catch (err) {[m
[31m-      console.error(err);[m
[31m-      alert('Error al abrir el portal de facturaci√≥n.');[m
[32m+[m[32m      return[m
     }[m
[31m-  };[m
 [m
[31m-  const handleSignOut = async () => {[m
[31m-    console.log('üî¥ CERRANDO SESI√ìN - Inicio');[m
[31m-    await signOut();[m
[31m-    console.log(' signOut() ejecutado');[m
[31m-    setView('gallery');[m
[31m-    setShowLogin(false);[m
[31m-    setShowRegister(false);[m
[31m-    setShowCheckout(false);[m
[31m-    setMobileMenuOpen(false);[m
[31m-    // Recargar para limpiar todo el estado[m
[31m-    setTimeout(() => {[m
[31m-      console.log(' Recargando p√°gina...');[m
[31m-    window.location.reload();[m
[31m-    }, 100);[m
[31m-  };[m
[32m+[m[32m    if (!user) {[m
[32m+[m[32m      setShowAuth(true)[m
[32m+[m[32m      setAuthMode('login')[m
[32m+[m[32m      return[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    setView(action)[m
[32m+[m[32m  }[m
 [m
   return ([m
[31m-    <div className="min-h-screen bg-[color:var(--bg)] text-[color:var(--fg)] font-body">[m
[31m-      {/* NAV */}[m
[31m-      <nav className="fixed top-0 w-full z-50 bg-[color:var(--bg)]/80 backdrop-blur-lg border-b border-[color:var(--border]">[m
[32m+[m[32m    <div className="min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-900">[m
[32m+[m[32m      {/* Header */}[m
[32m+[m[32m      <header className="fixed top-0 left-0 right-0 z-40 bg-black/50 backdrop-blur-md border-b border-white/10">[m
         <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">[m
[31m-          <div className="flex justify-between items-center h-20">[m
[31m-            <div className="absolute left-1/2 transform -translate-x-1/2 md:static md:transform-none md:left-0 md:pl-2">[m
[31m-              <button type="button" onClick={() => navigateToPage('home')} className="flex items-center">[m
[31m-                <img src="/logo.svg" alt="Promptraits Logo" className="w-[220px] md:w-[300px] h-auto" />[m
[31m-              </button>[m
[31m-            </div>[m
[31m-[m
[31m-            <div className="hidden md:flex items-center gap-4">[m
[31m-              <button onClick={() => navigateToPage('gallery')} className="text-gray-300 hover:text-white transition duration-300">[m
[31m-                Galer√≠a[m
[31m-              </button>[m
[31m-              <bu